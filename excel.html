<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Excel portfolio deep dive for Ray Mhlongo." />
  <title>Excel | Ray Mhlongo</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<div id="app" aria-hidden="true">
    <canvas id="canvas"></canvas>
  </div>
  <a class="skip-link" href="#main-content">Skip to main content</a>
  <header class="site-header">
    <nav class="navbar container" aria-label="Primary">
      <a class="brand brand-with-logo" href="index.html" aria-label="Data Insights by Ray">
  <img class="brand-logo" src="images/LOGOO.jpeg" alt="Ray Mhlongo logo" />
  <span class="brand-lines">
    <span class="brand-text">Data</span>
    <span class="brand-text">Insights</span>
    <span class="brand-text">by</span>
    <span class="brand-text">Ray</span>
  </span>
</a>
      <button class="nav-toggle" aria-controls="nav-list" aria-expanded="false"><span class="sr-only">Open menu</span>&#9776;</button>
      <ul id="nav-list" class="nav-list">
        <li><a class="nav-link" href="index.html">Home</a></li>
        <li><a class="nav-link" href="about.html">About</a></li>
        <li><a class="nav-link" href="projects.html">Projects</a></li>
        <li><a class="nav-link" href="contact.html">Contact</a></li>
      </ul>
      <button class="theme-toggle" type="button" aria-pressed="false">Light mode</button>
    </nav>
  </header>

  <main id="main-content" class="container page-main">
    <section class="section reveal">
      <div class="skill-page-hero">
        <div>
          <p class="hero-eyebrow">Excel Portfolio</p>
          <h1>Church Survey Insights (Excel)</h1>
          <p class="lead">I turn church survey responses into clear, trustworthy insights for leaders. The dashboard below uses real response fields (welcoming, attendance, serving, communication) and updates instantly by tenure segment.</p>
          <div class="hero-actions">
            <a class="btn btn-primary" href="projects.html">See Excel Projects</a>
            <a class="btn btn-secondary" href="index.html#skills-polish-title">Back to Skills</a>
          </div>
        </div>
        <div class="skill-stats">
          <div class="skill-stat-card">
            <h3>Modeling</h3>
            <p>Structured tables, consistent naming, validation, and error checks.</p>
          </div>
          <div class="skill-stat-card">
            <h3>Analysis</h3>
            <p>Pivot tables, conditional aggregations, and scenario planning.</p>
          </div>
          <div class="skill-stat-card">
            <h3>Reporting</h3>
            <p>Clean dashboards, KPI scorecards, and commentary-ready outputs.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="section reveal" aria-labelledby="excel-dashboard-title">
      <div class="section-heading">
        <h2 id="excel-dashboard-title">Interactive Excel Summary</h2>
        <p>Simulated workbook: filter by tenure to recalc the pivot summary from the survey.</p>
      </div>
      <div class="chip-row" data-filter-row>
        <button class="filter-chip active" data-tenure="All">All Tenures</button>
        <button class="filter-chip" data-tenure="New here">New here</button>
        <button class="filter-chip" data-tenure="6-12 months">6-12 months</button>
        <button class="filter-chip" data-tenure="1-3 years">1-3 years</button>
        <button class="filter-chip" data-tenure="3+ years">3+ years</button>
      </div>
      <div class="metric-grid" data-metric-grid>
        <div class="metric-card">
          <h4>Total Responses</h4>
          <p data-metric="responses">0</p>
        </div>
        <div class="metric-card">
          <h4>Very Welcoming</h4>
          <p data-metric="welcoming">0%</p>
        </div>
        <div class="metric-card">
          <h4>Serving Rate</h4>
          <p data-metric="serving">0%</p>
        </div>
        <div class="metric-card">
          <h4>Likely to Invite</h4>
          <p data-metric="invite">0%</p>
        </div>
      </div>
      <table class="data-table" aria-label="Survey responses table">
        <thead>
          <tr>
            <th>Timestamp</th>
            <th>Tenure</th>
            <th>Attendance</th>
            <th>Welcoming</th>
            <th>Serving</th>
            <th>Invite Likelihood</th>
          </tr>
        </thead>
        <tbody data-table-body></tbody>
      </table>
    </section>

    <section class="section reveal" aria-labelledby="excel-tech-title">
      <div class="section-heading">
        <h2 id="excel-tech-title">Workbook Architecture</h2>
        <p>Designed for clarity, speed, and stakeholder trust.</p>
      </div>
      <div class="grid details">
        <article class="detail-card">
          <h3>Input Layer</h3>
          <ul>
            <li>Power Query ingestion with standardized column mapping.</li>
            <li>Data validation, duplicates checks, and audit flags.</li>
            <li>Consistent data types, trimming, and error trapping.</li>
          </ul>
        </article>
        <article class="detail-card">
          <h3>Analysis Layer</h3>
          <ul>
            <li>Pivot summaries by region, account, and product.</li>
            <li>Dynamic arrays with structured references.</li>
            <li>Lookup logic: XLOOKUP, INDEX/MATCH, and IFERROR.</li>
          </ul>
        </article>
        <article class="detail-card">
          <h3>Reporting Layer</h3>
          <ul>
            <li>Executive scorecards with clear KPI definitions.</li>
            <li>Conditional formatting and variance highlights.</li>
            <li>Scenario toggles for best/base/worst cases.</li>
          </ul>
        </article>
      </div>
    </section>

    <section class="section reveal" aria-labelledby="excel-skills-title">
      <div class="section-heading">
        <h2 id="excel-skills-title">Junior Analyst Excel Skills</h2>
        <p>Everyday skills I use to keep analysis accurate, readable, and trusted.</p>
      </div>
      <div class="grid details">
        <article class="detail-card">
          <h3>Core Functions</h3>
          <ul>
            <li>SUM, AVERAGE, COUNT, MIN/MAX, ROUND.</li>
            <li>IF, IFS, AND/OR, IFERROR.</li>
            <li>XLOOKUP, INDEX/MATCH, TEXT, DATE.</li>
          </ul>
        </article>
        <article class="detail-card">
          <h3>Data Cleaning</h3>
          <ul>
            <li>TRIM, CLEAN, SUBSTITUTE, LEFT/RIGHT/MID.</li>
            <li>Remove duplicates, text-to-columns, data validation.</li>
            <li>Consistent naming and structured tables.</li>
          </ul>
        </article>
        <article class="detail-card">
          <h3>Analysis & Summaries</h3>
          <ul>
            <li>Pivot tables, groupings, and filters.</li>
            <li>Conditional formatting for insights.</li>
            <li>Basic statistics and variance analysis.</li>
          </ul>
        </article>
        <article class="detail-card">
          <h3>Presentation</h3>
          <ul>
            <li>Charts: bar, line, combo, and waterfall.</li>
            <li>Dashboard layout and visual hierarchy.</li>
            <li>Clear labels, annotations, and footnotes.</li>
          </ul>
        </article>
      </div>
    </section>
  </main>

  <footer class="site-footer"><div class="container footer-inner"><p>&copy; <span id="year"></span> Ray Mhlongo</p><p>Handcrafted with semantic HTML, modern CSS, and vanilla JavaScript.</p></div></footer>
<script type="module" src="tubes-cursor.js"></script>
  <script src="script.js"></script>
  <script>
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSxJjE9vK1zeGHt-CwLPsriQqh3gNYdDqF24kjMvTTuShdzOcmWzQ0Tr7jaaJ-XZL2TUFa88lTORk5U/pub?output=csv";

    const parseCSV = text => {
      const rows = [];
      let row = [];
      let current = "";
      let inQuotes = false;

      for (let i = 0; i < text.length; i++) {
        const char = text[i];
        const next = text[i + 1];

        if (char === '"' && inQuotes && next === '"') {
          current += '"';
          i++;
          continue;
        }
        if (char === '"') {
          inQuotes = !inQuotes;
          continue;
        }
        if (char === "," && !inQuotes) {
          row.push(current.trim());
          current = "";
          continue;
        }
        if ((char === "\n" || char === "\r") && !inQuotes) {
          if (current.length || row.length) {
            row.push(current.trim());
            rows.push(row);
          }
          row = [];
          current = "";
          continue;
        }
        current += char;
      }

      if (current.length || row.length) {
        row.push(current.trim());
        rows.push(row);
      }
      return rows.filter(r => r.length && r.some(cell => cell.length));
    };

    const normalize = value => (value || "").trim().replace(/[\u2013\u2014]/g, "-");

    const toSurveyRows = rows => {
      const [header, ...dataRows] = rows;
      const index = name => header.indexOf(name);

      const idx = {
        timestamp: index("Timestamp"),
        tenure: index("How long have you been attending the church?"),
        attendance: index("How often do you usually attend?"),
        welcoming: index("How welcoming does the church feel to you?"),
        serving: index("Are you currently serving in a team?"),
        servingFrequency: index("If you are serving, how often do you serve?"),
        invite: index("How likely are you to invite someone to church?"),
        navigation: index("How easy is it to find your way around the church?"),
        communication: index("How satisfied are you with the church communication (WhatsApp, emails, announcements)?")
      };

      return dataRows.map(row => ({
        timestamp: normalize(row[idx.timestamp]),
        tenure: normalize(row[idx.tenure]) || "Unspecified",
        attendance: normalize(row[idx.attendance]) || "Unspecified",
        welcoming: normalize(row[idx.welcoming]) || "Unspecified",
        serving: normalize(row[idx.serving]) || "No",
        servingFrequency: normalize(row[idx.servingFrequency]) || "Not serving",
        invite: normalize(row[idx.invite]) || "Not sure",
        navigation: normalize(row[idx.navigation]) || "Unspecified",
        communication: normalize(row[idx.communication]) || "Unspecified"
      }));
    };

    const formatPercent = value => `${Math.round(value)}%`;

    const renderDashboard = (surveyData, tenure) => {
      const filtered = tenure === "All" ? surveyData : surveyData.filter(row => row.tenure === tenure);
      const total = filtered.length;

      const veryWelcoming = filtered.filter(row => row.welcoming.toLowerCase() === "very welcoming").length;
      const serving = filtered.filter(row => row.serving.toLowerCase() === "yes").length;
      const inviteLikely = filtered.filter(row => ["likely", "very likely"].includes(row.invite.toLowerCase())).length;

      document.querySelector('[data-metric="responses"]').textContent = total.toLocaleString("en-ZA");
      document.querySelector('[data-metric="welcoming"]').textContent = total ? formatPercent((veryWelcoming / total) * 100) : "0%";
      document.querySelector('[data-metric="serving"]').textContent = total ? formatPercent((serving / total) * 100) : "0%";
      document.querySelector('[data-metric="invite"]').textContent = total ? formatPercent((inviteLikely / total) * 100) : "0%";

      const body = document.querySelector('[data-table-body]');
      body.innerHTML = "";
      filtered.slice(0, 18).forEach(row => {
        const tr = document.createElement('tr');
        const servingDisplay = row.serving === "Yes"
          ? (row.servingFrequency && row.servingFrequency !== "Not serving" ? row.servingFrequency : "Serving (frequency not provided)")
          : "Not serving";
        tr.innerHTML = `
          <td>${row.timestamp || "-"}</td>
          <td>${row.tenure}</td>
          <td>${row.attendance}</td>
          <td>${row.welcoming}</td>
          <td>${servingDisplay}</td>
          <td>${row.invite}</td>
        `;
        body.appendChild(tr);
      });
    };

    const setupFilters = surveyData => {
      document.querySelectorAll('[data-tenure]').forEach(button => {
        button.addEventListener('click', () => {
          document.querySelectorAll('[data-tenure]').forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
          renderDashboard(surveyData, button.dataset.tenure);
        });
      });
    };

    fetch(sheetUrl)
      .then(response => response.text())
      .then(csvText => {
        const rows = parseCSV(csvText);
        const surveyData = toSurveyRows(rows).filter(row => row.timestamp);
        setupFilters(surveyData);
        renderDashboard(surveyData, "All");
      })
      .catch(() => {
        const fallback = [
          { timestamp: "18/01/2026 13:59:46", tenure: "3+ years", attendance: "Every week", welcoming: "Slightly welcoming", serving: "Yes", servingFrequency: "Every week", invite: "Likely" },
          { timestamp: "21/01/2026 09:26:31", tenure: "1-3 years", attendance: "Most weeks", welcoming: "Very welcoming", serving: "No", servingFrequency: "Not serving", invite: "Very likely" },
          { timestamp: "01/02/2026 20:44:38", tenure: "1-3 years", attendance: "Most weeks", welcoming: "Not welcoming", serving: "No", servingFrequency: "Not serving", invite: "Not sure" },
          { timestamp: "02/02/2026 16:53:11", tenure: "New here", attendance: "Most weeks", welcoming: "Very welcoming", serving: "No", servingFrequency: "Not serving", invite: "Not sure" }
        ];
        setupFilters(fallback);
        renderDashboard(fallback, "All");
      });
  </script>
</body>
</html>



